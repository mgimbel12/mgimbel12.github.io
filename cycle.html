<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cycles Dashboard: Moon, Rain, Water, Air</title>
  <style>
    :root {
      --bg: #0b1220;
      --panel: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #22d3ee;    /* cyan */
      --accent-2: #a78bfa;  /* purple */
      --accent-3: #10b981;  /* green */
      --accent-4: #f59e0b;  /* amber */
      --border: rgba(255,255,255,0.12);
      --chip: #1f2937;
      --focus: #ffffff;
    }

    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(circle at 20% 0%, #0e1628 0%, var(--bg) 50%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      display: grid;
      place-items: center;
    }

    .container {
      width: min(1000px, 95vw);
      padding: 24px;
    }

    .dashboard {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 16px;
      box-shadow: 0 16px 40px rgba(0,0,0,0.35);
      overflow: hidden;
    }

    header.top {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 12px;
      padding: 20px;
      border-bottom: 1px solid var(--border);
    }
    .title { font-weight: 800; letter-spacing: 0.3px; }

    .tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .tab {
      background: var(--chip);
      color: var(--text);
      border: 1px solid var(--border);
      padding: 8px 12px;
      border-radius: 999px;
      cursor: pointer;
      transition: transform 100ms ease, border-color 120ms ease;
    }
    .tab:hover { transform: translateY(-1px); border-color: var(--accent); }
    .tab.active { background: linear-gradient(90deg, var(--accent), var(--accent-2)); color: #041019; border-color: transparent; }

    .grid {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
    }

    @media (max-width: 880px) {
      .grid { grid-template-columns: 1fr; }
    }

    section.panel {
      padding: 20px;
    }
    section.panel + section.panel { border-left: 1px solid var(--border); }
    @media (max-width: 880px) {
      section.panel + section.panel { border-left: none; border-top: 1px solid var(--border); }
    }

    h2 { margin: 0 0 12px; font-size: 1.1rem; font-weight: 700; }

    /* Diagram area */
    .diagram {
      position: relative;
      height: 360px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: rgba(255,255,255,0.03);
      overflow: hidden;
    }
    .center-label {
      position: absolute;
      bottom: 12px; right: 12px;
      color: var(--muted);
      font-size: 0.85rem;
    }

    /* Moon diagram */
    .sky {
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 70% 20%, #0a1930, #071223);
    }
    .stars {
      position: absolute; inset: 0; pointer-events: none;
      background-image:
        radial-gradient(2px 2px at 20% 30%, #ffffffaa, transparent),
        radial-gradient(2px 2px at 60% 50%, #ffffff88, transparent),
        radial-gradient(2px 2px at 80% 15%, #ffffff66, transparent),
        radial-gradient(2px 2px at 35% 70%, #ffffff88, transparent);
      background-repeat: no-repeat;
    }
    .moon {
      position: absolute; top: 50%; left: 50%;
      width: 120px; height: 120px;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      background: radial-gradient(circle at 30% 30%, #fff, #d9d9d9 60%, #c0c0c0 100%);
      box-shadow: 0 0 20px #ffffff55;
      overflow: hidden;
    }
    .shadow {
      position: absolute; inset: 0;
      background: radial-gradient(circle at var(--shadow-x, 0%) 50%, #0b1220 0%, #0b1220 50%, transparent 52%);
      mix-blend-mode: multiply;
      transition: all 500ms ease;
    }

    /* Rain diagram */
    .clouds {
      position: absolute; top: 40px; left: 50%;
      transform: translateX(-50%);
      width: 80%;
      height: 100px;
      background:
        radial-gradient(60px 40px at 20% 50%, #e5e7eb, transparent),
        radial-gradient(80px 50px at 40% 50%, #d1d5db, transparent),
        radial-gradient(60px 40px at 60% 50%, #e5e7eb, transparent),
        radial-gradient(70px 50px at 80% 50%, #d1d5db, transparent);
      filter: drop-shadow(0 6px 10px rgba(0,0,0,0.25));
    }
    .raindrop {
      position: absolute;
      top: 140px;
      width: 3px; height: 16px;
      background: linear-gradient(#74c0f6, #3b82f6);
      border-radius: 999px;
      animation: fall 1.2s linear infinite;
      opacity: 0;
    }
    @keyframes fall {
      0%   { transform: translateY(0); opacity: 0; }
      10%  { opacity: 1; }
      100% { transform: translateY(160px); opacity: 0; }
    }

    /* Water cycle diagram */
    .lake {
      position: absolute; bottom: 0; left: 0; right: 0;
      height: 120px;
      background: linear-gradient(#1e3a8a, #0ea5e9);
    }
    .sun {
      position: absolute; top: 24px; left: 24px;
      width: 60px; height: 60px; border-radius: 50%;
      background: radial-gradient(circle at 40% 40%, #fff3, #f59e0b);
      box-shadow: 0 0 20px #f59e0b88;
    }
    .vapour {
      position: absolute; bottom: 120px; left: 50%;
      width: 8px; height: 8px; border-radius: 50%;
      background: #a78bfa;
      filter: blur(1px);
      animation: rise 2.2s ease-in infinite;
      opacity: 0;
    }
    @keyframes rise {
      0% { transform: translate(-50%, 0) scale(0.6); opacity: 0; }
      30% { opacity: 1; }
      100% { transform: translate(-50%, -120px) scale(0.9); opacity: 0; }
    }

    /* Air cycle diagram */
    .arrows {
      position: absolute; inset: 20px;
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;
    }
    .arrow {
      border: 2px solid var(--accent-3);
      border-radius: 10px;
      position: relative;
      opacity: 0.3;
      transition: opacity 300ms ease, border-color 300ms ease;
    }
    .arrow::after {
      content: '';
      position: absolute; right: 10px; top: 50%;
      width: 0; height: 0;
      border-top: 6px solid transparent;
      border-bottom: 6px solid transparent;
      border-left: 10px solid var(--accent-3);
      transform: translateY(-50%);
    }
    .arrow.active {
      opacity: 1;
      border-color: var(--accent);
    }
    .air-label {
      position: absolute; top: 10px; left: 10px;
      font-size: 0.85rem; color: var(--muted);
    }

    /* Controls and timeline */
    .controls {
      display: grid;
      grid-template-columns: auto auto auto 1fr;
      gap: 8px; align-items: center;
      margin: 12px 0;
    }
    button {
      background: #1e293b; color: var(--text);
      border: 1px solid var(--border);
      padding: 8px 12px; border-radius: 10px;
      cursor: pointer;
      transition: transform 100ms ease, border-color 120ms ease, background 120ms ease;
    }
    button:hover { transform: translateY(-1px); border-color: var(--accent); }
    button:focus-visible { outline: 3px solid var(--focus); outline-offset: 2px; }
    .primary { background: var(--accent); color: #041019; border-color: transparent; }
    .danger  { background: #ef4444; color: #fff; }

    .speed {
      display: inline-flex; gap: 8px; align-items: center;
      color: var(--muted); font-size: 0.9rem;
    }
    select {
      background: #0b1220; color: var(--text);
      border: 1px solid var(--border); border-radius: 8px; padding: 6px 8px;
    }

    .timeline {
      border: 1px solid var(--border);
      border-radius: 12px;
      overflow: hidden;
    }
    .phase-list {
      display: grid; grid-template-columns: 1fr;
      max-height: 220px; overflow: auto;
      background: rgba(255,255,255,0.03);
    }
    .phase {
      display: grid; grid-template-columns: auto 1fr auto;
      gap: 8px; align-items: center;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
    }
    .phase:last-child { border-bottom: none; }
    .idx {
      background: var(--chip); border: 1px solid var(--border);
      border-radius: 999px; padding: 4px 10px; font-size: 0.8rem;
    }
    .name { font-weight: 700; }
    .desc { color: var(--muted); font-size: 0.9rem; }

    .progress {
      height: 10px; background: #0b1220; border: 1px solid var(--border);
      border-radius: 999px; overflow: hidden; margin-top: 8px;
    }
    .bar {
      height: 100%; width: 0%;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      transition: width 200ms linear;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="dashboard" role="application" aria-label="Cycles dashboard">
      <header class="top">
        <div class="title">Cycles Dashboard</div>
        <nav class="tabs" role="tablist" aria-label="Cycle tabs">
          <button class="tab active" role="tab" aria-selected="true" aria-controls="panel-moon" id="tab-moon">Moon</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-rain" id="tab-rain">Rain</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-water" id="tab-water">Water</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="panel-air" id="tab-air">Air</button>
        </nav>
      </header>

      <div class="grid">
        <!-- Left: Diagram -->
        <section class="panel" aria-labelledby="diagramTitle">
          <h2 id="diagramTitle">Cycle diagram</h2>
          <div class="diagram" id="diagram" aria-live="polite">
            <!-- Moon layer -->
            <div class="sky"></div>
            <div class="stars"></div>
            <div class="moon" id="moon">
              <div class="shadow" id="moonShadow"></div>
            </div>

            <!-- Rain layer -->
            <div class="clouds" id="clouds" hidden></div>
            <!-- create raindrops dynamically -->

            <!-- Water cycle layer -->
            <div class="sun" id="sun" hidden></div>
            <div class="lake" id="lake" hidden></div>
            <!-- vapour created dynamically -->

            <!-- Air cycle layer -->
            <div class="arrows" id="airArrows" hidden>
              <div class="arrow" id="air1"><span class="air-label">Warming & rising</span></div>
              <div class="arrow" id="air2"><span class="air-label">Cooling & sinking</span></div>
              <div class="arrow" id="air3"><span class="air-label">Pressure flow</span></div>
            </div>

            <div class="center-label" id="centerLabel">Moon: New</div>
          </div>

          <div class="controls" role="group" aria-label="Playback controls">
            <button class="primary" id="playBtn">Play</button>
            <button id="pauseBtn">Pause</button>
            <button class="danger" id="resetBtn">Reset</button>
            <div class="speed">
              <span>Speed</span>
              <select id="speedSel" aria-label="Playback speed">
                <option value="1000">1×</option>
                <option value="700">1.5×</option>
                <option value="500">2×</option>
              </select>
            </div>
          </div>

          <div class="progress" aria-label="Phase progress"><div class="bar" id="bar"></div></div>
        </section>

        <!-- Right: Timeline -->
        <section class="panel" aria-labelledby="timelineTitle">
          <h2 id="timelineTitle">Phases timeline</h2>
          <div class="timeline">
            <div class="phase-list" id="phaseList"></div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script>
    // Data for cycles
    const CYCLES = {
      moon: {
        name: 'Moon',
        phases: [
          { name: 'New', desc: 'Moon between Earth and Sun; face appears dark.' },
          { name: 'Waxing Crescent', desc: 'Thin crescent grows on the right.' },
          { name: 'First Quarter', desc: 'Right half illuminated.' },
          { name: 'Waxing Gibbous', desc: 'More than half lit, approaching full.' },
          { name: 'Full', desc: 'Face fully illuminated.' },
          { name: 'Waning Gibbous', desc: 'Light decreases after full.' },
          { name: 'Last Quarter', desc: 'Left half illuminated.' },
          { name: 'Waning Crescent', desc: 'Thin crescent fades to new.' }
        ],
        renderPhase: (idx) => {
          const pcts = [0, 15, 25, 45, 50, 75, 85, 95]; // shadow offset approximation
          const x = pcts[idx] + '%';
          const shadow = document.getElementById('moonShadow');
          shadow.style.setProperty('--shadow-x', x);
          document.getElementById('centerLabel').textContent = `Moon: ${CYCLES.moon.phases[idx].name}`;
          // show moon, hide others
          showLayer('moon');
        }
      },
      rain: {
        name: 'Rain',
        phases: [
          { name: 'Cloud formation', desc: 'Moist air cools and condenses into clouds.' },
          { name: 'Droplet growth', desc: 'Tiny droplets merge into larger ones.' },
          { name: 'Precipitation', desc: 'Raindrops fall when heavy enough.' },
          { name: 'Runoff', desc: 'Water flows over land to rivers and lakes.' }
        ],
        renderPhase: (idx) => {
          const label = CYCLES.rain.phases[idx].name;
          document.getElementById('centerLabel').textContent = `Rain: ${label}`;
          showLayer('rain');
          // raindrops only during precipitation
          spawnRaindrops(idx === 2 ? 20 : 0);
        }
      },
      water: {
        name: 'Water',
        phases: [
          { name: 'Evaporation', desc: 'Sun heats water; turns to vapor rising up.' },
          { name: 'Condensation', desc: 'Vapor cools, forms clouds.' },
          { name: 'Precipitation', desc: 'Water falls as rain.' },
          { name: 'Collection', desc: 'Water collects in lakes, rivers, oceans.' }
        ],
        renderPhase: (idx) => {
          showLayer('water');
          document.getElementById('centerLabel').textContent = `Water: ${CYCLES.water.phases[idx].name}`;
          spawnVapour(idx === 0 ? 8 : 0); // vapour during evaporation
        }
      },
      air: {
        name: 'Air',
        phases: [
          { name: 'Heating', desc: 'Sun warms surface; air gains energy.' },
          { name: 'Rising', desc: 'Warm air expands and rises (low pressure).' },
          { name: 'Cooling', desc: 'Air cools aloft, becomes denser.' },
          { name: 'Sinking', desc: 'Cool air descends (high pressure).' },
          { name: 'Flow', desc: 'Air moves from high to low pressure.' }
        ],
        renderPhase: (idx) => {
          showLayer('air');
          document.getElementById('centerLabel').textContent = `Air: ${CYCLES.air.phases[idx].name}`;
          const ids = ['air1','air1','air2','air2','air3'];
          document.querySelectorAll('.arrow').forEach(a => a.classList.remove('active'));
          const el = document.getElementById(ids[idx]);
          if (el) el.classList.add('active');
        }
      }
    };

    // Layer visibility manager
    function showLayer(which) {
      // moon: show sky/moon
      document.getElementById('moon').hidden = which !== 'moon';
      document.querySelector('.sky').hidden = which !== 'moon';
      document.querySelector('.stars').hidden = which !== 'moon';
      // rain
      document.getElementById('clouds').hidden = which !== 'rain';
      // remove raindrops when hidden
      if (which !== 'rain') clearDrops();
      // water
      document.getElementById('sun').hidden = which !== 'water';
      document.getElementById('lake').hidden = which !== 'water';
      if (which !== 'water') clearVapour();
      // air
      document.getElementById('airArrows').hidden = which !== 'air';
    }

    // Tabs
    const tabs = {
      moon: document.getElementById('tab-moon'),
      rain: document.getElementById('tab-rain'),
      water: document.getElementById('tab-water'),
      air: document.getElementById('tab-air')
    };
    const phaseListEl = document.getElementById('phaseList');
    const barEl = document.getElementById('bar');

    let currentCycleKey = 'moon';
    let currentIdx = 0;
    let timer = null;
    let speedMs = 1000;

    function renderTimeline(cycleKey) {
      const { phases } = CYCLES[cycleKey];
      phaseListEl.innerHTML = '';
      phases.forEach((p, i) => {
        const row = document.createElement('div');
        row.className = 'phase';
        const idx = document.createElement('span'); idx.className = 'idx'; idx.textContent = i + 1;
        const name = document.createElement('span'); name.className = 'name'; name.textContent = p.name;
        const desc = document.createElement('span'); desc.className = 'desc'; desc.textContent = p.desc;
        row.append(idx, name, desc);
        phaseListEl.appendChild(row);
      });
      updateProgress();
    }

    function updateProgress() {
      const total = CYCLES[currentCycleKey].phases.length;
      const pct = ((currentIdx) / (total - 1)) * 100;
      barEl.style.width = Math.max(0, Math.min(100, pct)) + '%';
    }

    function setActiveTab(key) {
      Object.entries(tabs).forEach(([k, btn]) => {
        const active = k === key;
        btn.classList.toggle('active', active);
        btn.setAttribute('aria-selected', active ? 'true' : 'false');
      });
    }

    function renderPhase() {
      CYCLES[currentCycleKey].renderPhase(currentIdx);
      updateProgress();
    }

    function play() {
      if (timer) return;
      timer = setInterval(() => {
        step(1);
      }, speedMs);
    }
    function pause() { if (timer) { clearInterval(timer); timer = null; } }
    function reset() { pause(); currentIdx = 0; renderPhase(); }

    function step(dir) {
      const total = CYCLES[currentCycleKey].phases.length;
      currentIdx = (currentIdx + dir + total) % total;
      renderPhase();
    }

    // Playback controls
    document.getElementById('playBtn').addEventListener('click', play);
    document.getElementById('pauseBtn').addEventListener('click', pause);
    document.getElementById('resetBtn').addEventListener('click', reset);
    document.getElementById('speedSel').addEventListener('change', (e) => {
      speedMs = parseInt(e.target.value, 10);
      if (timer) { pause(); play(); }
    });

    // Tab events
    Object.entries(tabs).forEach(([key, btn]) => {
      btn.addEventListener('click', () => {
        pause();
        currentCycleKey = key;
        currentIdx = 0;
        setActiveTab(key);
        renderTimeline(key);
        renderPhase();
        document.getElementById('diagramTitle').textContent = `Cycle diagram`;
        document.getElementById('timelineTitle').textContent = `Phases timeline`;
      });
    });

    // Rain drops
    const diagramEl = document.getElementById('diagram');
    function spawnRaindrops(count) {
      clearDrops();
      for (let i = 0; i < count; i++) {
        const drop = document.createElement('div');
        drop.className = 'raindrop';
        drop.style.left = 10 + Math.random() * (diagramEl.clientWidth - 20) + 'px';
        drop.style.animationDelay = (Math.random() * 0.8) + 's';
        drop.style.opacity = '1';
        diagramEl.appendChild(drop);
      }
    }
    function clearDrops() {
      document.querySelectorAll('.raindrop').forEach(d => d.remove());
    }

    // Vapour bubbles
    function spawnVapour(count) {
      clearVapour();
      for (let i = 0; i < count; i++) {
        const v = document.createElement('div');
        v.className = 'vapour';
        v.style.left = (40 + Math.random() * 20) + '%';
        v.style.animationDelay = (Math.random() * 1.2) + 's';
        v.style.opacity = '1';
        diagramEl.appendChild(v);
      }
    }
    function clearVapour() {
      document.querySelectorAll('.vapour').forEach(v => v.remove());
    }

    // Init
    renderTimeline('moon');
    renderPhase();
  </script>
</body>
</html>

